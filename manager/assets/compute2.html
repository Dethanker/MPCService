<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>MPC service</title>
  <link rel="stylesheet" href="./style/index.css">
</head>

<!-- Code for wasm -->

<script src="wasm_exec.js"></script>
<script type="text/javascript" src="load_wasm.js"></script>

<!-- Load custom js functions -->
<script type="text/javascript" src="mpc_utils.js"></script>
<script type="text/javascript" src="dataset_utils.js"></script>

<div style="text-align: center; margin-top: 50px; transform: translateX(100px);">
    <span style="margin-right: 200px; font-size: 20px;">1.公私钥生成</span>
    <span id="figure" style="margin-right: 200px; font-size: 20px;">2.参数设置</span>
    <span style="font-size: 20px;">3.结果查看</span>
  </div>
  
  <style>
    .select1 {
        font-size: 20px;
        padding: 10px;
        width: 200px;
    }
    </style>
    
    <div style="text-align: center; margin-top: 50px;">
        <span style="font-size: 20px;">数据集：</span>
        <select class= select1 name="dataset" onchange="if(this.value==''){this.style.color='#b5b5b5'}else{this.style.color='#000000'}">
            <option value="" selected disabled hidden>请选择</option>
            <option value="dataset_test1">dataset_test1</option>
            <option value="dataset_test2">dataset_test2</option>
            <option value="dataset_test3">dataset_test3</option>
        </select>
    </div>

    <style>
        .select2 {
            font-size: 20px;
            padding: 10px;
            width: 200px;
        }
        </style>
        
        <div style="text-align: center; margin-top: 50px;">
            <span style="font-size: 20px;">计算程序：</span>
            <select class=select2 name="program" 
            >
                <option value="" selected disabled hidden>请选择</option>
                <option value="Average">Average</option>
                <option value="AbsoluteDeviation">AbsoluteDeviation</option>
                <option value="Minimum">Minimum</option>
                <option value="Quartile">Quartile</option>
                <option value="Medium">Medium</option>
                <option value="UpperQuartile">UpperQuartile</option>
                <option value="Maximum">Maximum</option>
                <option value="K">K-means</option>
                <option value="Variance">Variance</option>
                <option value="StandardDeviation">StandardDeviation</option>
                <option value="Sknewmess">Sknewmess</option>
                <option value="Kurtosis">Kurtosis</option>
                <option value="EuclideanDistance">EuclideanDistance</option>
            </select>
        </div>


          
        <style>
            .select3 {
                font-size: 20px;
                padding: 10px;
                width: 500px; /* 修改这里的宽度 */
            }
        </style>
        
        <div style="text-align: center; margin-top: 50px;">
            <span style="font-size: 20px;">节点：</span>
            <select class="select3" name="nodesxxx" onchange="if(this.value==''){this.style.color='#b5b5b5'}else{this.style.color='#000000'}">
                <option value="" selected disabled hidden>请选择</option>
                <option value="Berlin_node">Berlin_node</option>
                <option value="Paris_node">Paris_node</option>
                <option value="Ljubljana_node">Ljubljana_node</option>
            </select>
        </div>
        
              
            <script>
                var selectedOptions = [];
                
                document.querySelector('select[name="nodesxxx"]').addEventListener('change', function(event) {
                  var selectedOption = event.target.value;
                  if (selectedOption !== '') {
                    selectedOptions.push(selectedOption);
                    document.querySelector('select[name="nodesxxx"] option[value="' + selectedOption +'"]').disabled = true;
                    document.querySelector('select[name="nodesxxx"]').value = '';
                    updateSelectedOptions();
                  }
                });
                
                function updateSelectedOptions() {
                  var selectedOptionsText = selectedOptions.join('; ');
                  document.querySelector('select[name="nodesxxx"] option:first-of-type').textContent = selectedOptionsText || '请选择';
                }
                </script>

        
        
<style>
    .select4 {
        font-size: 20px;
        padding: 10px;
        width: 1000px; /* 修改这里的宽度 */
    }
</style>



      
<div style="text-align: center; margin-top: 50px;">
    <span style="font-size: 20px;">数据列：</span>
    <select class="select4" name="cols">
        <option value="" selected disabled hidden>请选择</option>
    </select>
</div>

<script>
var cols = document.querySelector('select[name="cols"]');
document.querySelector('select[name="dataset"]').addEventListener('change', function() {
    cols.innerHTML = '<option value="" selected disabled hidden>请选择</option>';
    if (this.value === 'dataset_test1') {
        var option = document.createElement('option');
        option.text ="diagnosis";
        option.value = "diagnosis";
        cols.add(option);
        var option = document.createElement('option');
option.text ="radius_mean";
option.value = "radius_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="texture_mean";
option.value = "texture_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="perimeter_mean";
option.value = "perimeter_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="area_mean";
option.value = "area_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="smoothness_mean";
option.value = "smoothness_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="compactness_mean";
option.value = "compactness_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="concavity_mean";
option.value = "concavity_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="concave_points_mean";
option.value = "concave_points_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="symmetry_mean";
option.value = "symmetry_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="fractal_dimension_mean";
option.value = "fractal_dimension_mean";
cols.add(option);

var option = document.createElement('option');
option.text ="radius_se";
option.value = "radius_se";
cols.add(option);

var option = document.createElement('option');
option.text ="texture_se";
option.value = "texture_se";
cols.add(option);

var option = document.createElement('option');
option.text ="perimeter_se";
option.value = "perimeter_se";
cols.add(option);

var option = document.createElement('option');
option.text ="area_se";
option.value = "area_se";
cols.add(option);

var option = document.createElement('option');
option.text ="smoothness_se";
option.value = "smoothness_se";
cols.add(option);

var option = document.createElement('option');
option.text ="compactness_se";
option.value = "compactness_se";
cols.add(option);

var option = document.createElement('option');
option.text ="concavity_se";
option.value = "concavity_se";
cols.add(option);

var option = document.createElement('option');
option.text ="concave_points_se";
option.value = "concave_points_se";
cols.add(option);

var option = document.createElement('option');
option.text ="symmetry_se";
option.value = "symmetry_se";
cols.add(option);

var option = document.createElement('option');
option.text ="fractal_dimension_se";
option.value = "fractal_dimension_se";
cols.add(option);

var option = document.createElement('option');
option.text ="radius_worst";
option.value = "radius_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="texture_worst";
option.value = "texture_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="perimeter_worst";
option.value = "perimeter_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="area_worst";
option.value = "area_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="smoothness_worst";
option.value = "smoothness_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="compactness_worst";
option.value = "compactness_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="concavity_worst";
option.value = "concavity_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="concave_points_worst";
option.value = "concave_points_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="symmetry_worst";
option.value = "symmetry_worst";
cols.add(option);

var option = document.createElement('option');
option.text ="fractal_dimension_worst";
option.value = "fractal_dimension_worst";
cols.add(option);
        
    } else {
        var option = document.createElement('option');
option.text ="male";
option.value = "male";
cols.add(option);

var option = document.createElement('option');
option.text ="age";
option.value = "age";
cols.add(option);

var option = document.createElement('option');
option.text ="education";
option.value = "education";
cols.add(option);

var option = document.createElement('option');
option.text ="currentSmoker";
option.value = "currentSmoker";
cols.add(option);

var option = document.createElement('option');
option.text ="cigsPerDay";
option.value = "cigsPerDay";
cols.add(option);

var option = document.createElement('option');
option.text ="BPMeds";
option.value = "BPMeds";
cols.add(option);

var option = document.createElement('option');
option.text ="prevalentStroke";
option.value = "prevalentStroke";
cols.add(option);

var option = document.createElement('option');
option.text ="prevalentHyp";
option.value = "prevalentHyp";
cols.add(option);

var option = document.createElement('option');
option.text ="diabetes";
option.value = "diabetes";
cols.add(option);

var option = document.createElement('option');
option.text ="totChol";
option.value = "totChol";
cols.add(option);

var option = document.createElement('option');
option.text ="sysBP";
option.value = "sysBP";
cols.add(option);

var option = document.createElement('option');
option.text ="diaBP";
option.value = "diaBP";
cols.add(option);

var option = document.createElement('option');
option.text ="BMI";
option.value = "BMI";
cols.add(option);

var option = document.createElement('option');
option.text ="heartRate";
option.value = "heartRate";
cols.add(option);

var option = document.createElement('option');
option.text ="glucose";
option.value = "glucose";
cols.add(option);

var option = document.createElement('option');
option.text ="TenYearCHD";
option.value = "TenYearCHD";
cols.add(option);
    
    }
});
</script>

<script>
    var selectedOptions2 = [];
    
    document.querySelector('select[name="cols"]').addEventListener('change', function(event) {
      var selectedOption2 = event.target.value;
      if (selectedOption2 !== '') {
        selectedOptions2.push(selectedOption2);
        document.querySelector('select[name="cols"] option[value="' + selectedOption2 +'"]').disabled = true;
        document.querySelector('select[name="cols"]').value = '';
        updateSelectedOptions2();
      }
    });
    
    function updateSelectedOptions2() {
      var selectedOptionsText2 = selectedOptions2.join('; ');
      document.querySelector('select[name="cols"] option:first-of-type').textContent = selectedOptionsText2 || '请选择';
    }

    </script>
        

  <div class="sidenav">
    <h3 style="width:100%; text-align:center; font-weight: bold; font-size: 28px; color: grey;">隐私数据共享系统</h3>
    <button id="new-computation" style="border-radius: 10px;">发起计算</button>
    <button id="history-info" style="border-radius: 10px;">历史计算</button>
    <script>
      var historyInfoButton = document.getElementById('history-info');
      historyInfoButton.addEventListener('click', () => {
        location.assign('history.html');
      });
    </script>
    <button id="node-info" style="border-radius: 10px;">节点信息</button>
    <script>
      var nodeInfoButton = document.getElementById('node-info');
      nodeInfoButton.addEventListener('click', () => {
        location.assign('nodes.html');
      });
    </script>
    <button id="dataset-info" style="border-radius: 10px;">数据集信息</button>
    <script>
      var datasetInfoButton = document.getElementById('dataset-info');
      datasetInfoButton.addEventListener('click', () => {
        location.assign('datasets.html');
      });
    </script>
  </div>

  <style>
    .select5 {
        font-size: 20px;
        padding: 10px;
        
    }
</style>
<div id="kmean" style="text-align: center; margin-top: 50px; display:none;">
    <span style="font-size: 20px;">K-means聚类数：</span>
    <select class="select5" name="kmeans" onchange="if(this.value==''){this.style.color='#b5b5b5'}else{this.style.color='#000000'}">
        <option value="" selected disabled hidden>请选择</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
    </select>
</div>

<script>
    const programSelect = document.querySelector('select[name="program"]');
    const kMeanDiv = document.getElementById('kmean');
    
    programSelect.addEventListener('change', () => {
      if (programSelect.value === 'K') {
        kMeanDiv.style.display = 'block';
      } else {
        kMeanDiv.style.display = 'none';
      }
    });
    </script>

<div class="error-msg" id="errorMsg" style="display:none"></div>

<p>
  <progress id="progressBar" max="100" value="0"></progress>
</p>

<div style="text-align: center; margin-top: 50px;transform: translateX(125px);">
    <button id="computeButton" style="background-color: blue; color: white; border-radius: 10px; padding: 10px 20px; font-size: 16px;"  >发起计算</button>
    </div> 
<script>
  var button=getElementById("computeButton");
  //mpc_computation();
  button.addEventListener("click", function() {
              // 创建一个div元素作为弹出框
              var popup = document.createElement("div");
          popup.classList.add("popup");
        
          // 创建标题元素
          var title = document.createElement("h2");
          title.classList.add("popup-title");
          title.innerHTML = "节点公钥";
        
          // 将标题和其他内容添加到弹出框中
          popup.appendChild(title);

          var spacer = document.createElement("div");
          spacer.classList.add("spacer"); // 添加class名称
          spacer.style.height = "30px"; // 设置高度
          popup.appendChild(spacer);



          var spacer2 = document.createElement("div");
          spacer2.classList.add("spacer"); // 添加class名称
          spacer2.style.height = "30px"; // 设置高度
          popup.appendChild(spacer2);
          // 添加确定按钮
          var btn = document.createElement("button");
          btn.innerHTML = "确定";
        
          // 将确定按钮添加到弹出框中，并添加点击事件监听器
          popup.appendChild(btn);
          btn.addEventListener("click", function() {
            // 关闭弹出框
            popup.remove();
          });
          // 添加弹出框到body元素中
          document.body.appendChild(popup);
  });
</script>      
  <style type="text/css">
      .blue-button {
    background-color: blue;
    color: white;
    border-radius: 10px; /* 设置圆角半径 */
    padding: 10px 20px; /* 设置内边距 */
  }
  .popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 1000px;
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
  }
  
  .popup-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
  }

  .popup button{
    background-color: blue;
    color: white;
    border-radius: 10px;
    padding: 10px 20px;
    margin-top: 40px;
    cursor: pointer;
    position: fixed;
    bottom: 0;
    right: 0;
  }
  .sidenav {
    height: 100%;
    width: 300px; /* 增加宽度 */
    position: fixed;
    top: 0;
    left: 0;
    background-color: #f1f1f1;
    overflow-x: hidden;
    padding-top: 20px;
  }
  
  .sidenav button {
    display: block;
    font-size: 16px;
    border: none;
    background-color: inherit;
    color: black;
    padding: 12px 16px;
    margin: 10px auto; /* 设置左右 margin 为 auto 实现居中 */
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    width: 50%; /* 让按钮宽度为容器宽度的一半 */
  }
  
  /* 当按钮被 hover 时改变背景色 */
  .sidenav button:hover {
    background-color: blue; /* 改变背景色为蓝色 */
    color: white; /* 同时改变字体颜色为白色以突出显示 */
  }
  .sidenav #new-computation {
  background-color: blue;
  color: white;
}
#figure {
  background-color: blue;
  color: white;
  border-radius: 10px;
  padding: 10px;
  display: inline-block;
}
  </style>